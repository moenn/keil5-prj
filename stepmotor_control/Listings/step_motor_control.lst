C51 COMPILER V9.56.0.0   STEP_MOTOR_CONTROL                                                11/28/2017 22:29:31 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE STEP_MOTOR_CONTROL
OBJECT MODULE PLACED IN .\Objects\step_motor_control.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE step_motor_control.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.
                    -\Listings\step_motor_control.lst) TABS(2) OBJECT(.\Objects\step_motor_control.obj)

line level    source

   1          #include "stc12c5a60s2.h"
   2          #include "intrins.h"
   3          #define uchar unsigned char
   4          #define uint unsigned int
   5          //#define th0 0xfc
   6          //#define tl0 0x18
   7          //void delay1ms(void);
   8          //void delay_nms(unsigned short int t);
   9          void init(void);
  10          
  11          //uchar code turn[8]={0x01,0x03,0x02,0x06,0x04,0x0c,0x08,0x09};
  12          uchar code turn[8] = {0x08,0x0c,0x04,0x06,0x02,0x03,0x01,0x09}; //45 degree per time
  13          //uchar code turn[] = {0x06,0x03,0x09,0x0c};  //90 degree per time
  14          //uint code speed[4] = {64536,63536,62536,61536};
  15          
  16          uchar i = 0;
  17          uint speed = 63536;
  18          //uchar speed_level = 0;
  19          
  20          //uchar flag_50ms = 0;
  21          bit turn_direction_flag = 0;
  22          int main()
  23          {
  24   1        init();
  25   1        while(1){
  26   2      
  27   2        }
  28   1        return 0;
  29   1      }
  30          
  31          void init(){
  32   1      
  33   1        TMOD = 0x01;
  34   1        TH0 = speed/256;
  35   1        TL0 = speed%256;
  36   1        //TH1 = 0x3c;
  37   1        //TL1 = 0xb0;
  38   1        //TH0 = th0;
  39   1        //TL0 = tl0;
  40   1        
  41   1        EA = 1;
  42   1        ET0 = 1;
  43   1        //ET1 = 1;
  44   1        //EX0 = 1;
  45   1        
  46   1        //IT0 = 1;
  47   1        //IT1 = 1;
  48   1        
  49   1        TR0 = 1;
  50   1        //TR1 = 1;
  51   1      }
  52          
  53          /*
  54          void int0() interrupt 0
C51 COMPILER V9.56.0.0   STEP_MOTOR_CONTROL                                                11/28/2017 22:29:31 PAGE 2   

  55          {
  56            turn_direction_flag = ~turn_direction_flag;
  57          }
  58          
  59          void int1() interrupt 2
  60          {
  61            
  62            speed_level = speed_level + 3 ;
  63            if(speed_level == 5){
  64              speed_level = 0;
  65            }
  66          }
  67          
  68          //moto turn func
  69          */
  70          void timer0() interrupt 1
  71          {
  72   1        //TH0 = speed/256;
  73   1        //TL0 = speed%256;
  74   1      
  75   1        TH0 = speed/256;
  76   1        TL0 = speed%256;
  77   1      
  78   1        //TH0 = th0;
  79   1        //TL0 = tl0;
  80   1        
  81   1        
  82   1        P2 = turn[i];
  83   1         //forward
  84   1        if(turn_direction_flag == 0){
  85   2          i++;
  86   2        }
  87   1        // backward
  88   1        else if(turn_direction_flag == 1){
  89   2          i--;
  90   2        }
  91   1        //i++;
  92   1        
  93   1        if(i == 8){
  94   2          i = 0;
  95   2        }
  96   1        
  97   1        if(i == -1){
  98   2          i = 7;
  99   2        }
 100   1        
 101   1      }
 102          
 103          /*
 104          void timer1() interrupt 3
 105          {
 106            TH1 = 0x3c;
 107            TL1 = 0xb0;
 108            
 109            speed--;
 110            if(speed == 63536){
 111              TR1 = 0;
 112              ET1 = 0;
 113            }
 114          
 115          }
 116          */
C51 COMPILER V9.56.0.0   STEP_MOTOR_CONTROL                                                11/28/2017 22:29:31 PAGE 3   

 117          
 118          
 119          /*
 120          void delay1ms(void)   //?? -0.018084490741us
 121          {
 122              unsigned char a,b;
 123              for(b=21;b>0;b--)
 124                  for(a=130;a>0;a--);
 125              _nop_();  //if Keil,require use intrins.h
 126          }
 127          
 128          void delay_nms(unsigned short int t)
 129          {
 130            unsigned short int i;
 131            for(i=0;i<t;i++){
 132              delay1ms();
 133            }
 134          }
 135          */
*** WARNING C294 IN LINE 28 OF step_motor_control.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     82    ----
   CONSTANT SIZE    =      8    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
